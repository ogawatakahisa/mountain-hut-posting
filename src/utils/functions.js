// 郵便番号から都道府県を取得する関数
function extractPrefecture(plainBody) {
  const postalCodeMap = {
    "00": "北海道", "04": "北海道", "05": "北海道", "06": "北海道", "07": "北海道", "08": "北海道", "09": "北海道",
    "01": "秋田",
    "02": "岩手",
    "03": "青森",
    "10": "東京", "11": "東京", "12": "東京", "13": "東京", "14": "東京", "15": "東京", "16": "東京", "17": "東京", "18": "東京", "19": "東京", "20": "東京",
    "21": "神奈川", "22": "神奈川", "23": "神奈川", "24": "神奈川", "25": "神奈川",
    "26": "千葉", "27": "千葉", "28": "千葉", "29": "千葉",
    "30": "茨城", "31": "茨城",
    "32": "栃木",
    "33": "埼玉", "34": "埼玉", "35": "埼玉", "36": "埼玉",
    "37": "群馬",
    "38": "長野", "39": "長野",
    "40": "山梨",
    "41": "静岡", "42": "静岡", "43": "静岡",
    "44": "愛知", "45": "愛知", "46": "愛知", "47": "愛知", "48": "愛知", "49": "愛知",
    "50": "岐阜",
    "51": "三重",
    "52": "滋賀",
    "53": "大阪", "54": "大阪", "55": "大阪", "56": "大阪", "57": "大阪", "58": "大阪", "59": "大阪",
    "60": "京都", "61": "京都", "62": "京都",
    "63": "奈良",
    "64": "和歌山",
    "65": "兵庫", "66": "兵庫", "67": "兵庫",
    "68": "鳥取",
    "69": "島根",
    "70": "岡山", "71": "岡山",
    "72": "広島", "73": "広島",
    "74": "山口", "75": "山口",
    "76": "香川",
    "77": "徳島",
    "78": "高知",
    "79": "愛媛",
    "80": "福岡", "81": "福岡", "82": "福岡", "83": "福岡",
    "84": "佐賀",
    "85": "長崎",
    "86": "熊本",
    "87": "大分",
    "88": "宮崎",
    "89": "鹿児島",
    "90": "沖縄",
    "91": "福井",
    "92": "石川",
    "93": "富山",
    "94": "新潟", "95": "新潟",
    "96": "福島", "97": "福島",
    "98": "宮城",
    "99": "山形"
  };
  const postalCodeMatch = plainBody.match(/郵便番号[:：]?\s*([0-9\-]{7,10})/);
  if (!postalCodeMatch) return "郵便番号入力エラー";
  const postalCodeRaw = postalCodeMatch[1].replace(/[^0-9]/g, ""); 
  const prefix = postalCodeRaw.slice(0, 2);
  return postalCodeMap[prefix] || "住所エラー";
  }